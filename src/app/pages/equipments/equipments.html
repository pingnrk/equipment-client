<div class="p-4">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-2xl font-bold text-gray-800">Inventory List</h2>

    <dx-button
      *ngIf="isAdmin"
      text="Add Equipment"
      icon="add"
      type="default"
      stylingMode="outlined"
      (onClick)="goToAddPage()"
    >
    </dx-button>
  </div>

  <dx-data-grid
    id="gridContainer"
    [dataSource]="equipments"
    [showBorders]="true"
    [rowAlternationEnabled]="true"
    [columnAutoWidth]="true"
    keyExpr="id"
    [(selectedRowKeys)]="selectedItemKeys"
  >
    <dxo-search-panel [visible]="true" [width]="300" placeholder="Search..."></dxo-search-panel>
    <dxo-filter-row [visible]="true"></dxo-filter-row>
    <dxo-paging [pageSize]="10"></dxo-paging>
    <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[10, 20, 50]"></dxo-pager>

    <dxi-column
      caption="Image"
      [width]="100"
      cellTemplate="imageCell"
      [allowFiltering]="false"
      [allowSorting]="false"
      alignment="center"
    ></dxi-column>
    <dxo-selection mode="multiple" showCheckBoxesMode="always" selectAllMode="page">
    </dxo-selection>

    <div *dxTemplate="let d of 'imageCell'">
      <img
        [src]="getFullImageUrl(d.data.imageUrl)"
        alt="Item"
        style="
          width: 50px;
          height: 50px;
          object-fit: cover;
          border-radius: 4px;
          display: block;
          margin: 0 auto;
        "
      />
    </div>

    <dxi-column dataField="code" caption="Code" [width]="120"></dxi-column>
    <dxi-column dataField="name" caption="Name"></dxi-column>
    <dxi-column dataField="stock" caption="Stock" [width]="80" alignment="center"></dxi-column>

    <dxi-column
      dataField="status"
      caption="Status"
      [width]="120"
      cellTemplate="statusCell"
      alignment="center"
    ></dxi-column>
    <div *dxTemplate="let d of 'statusCell'">
      <span class="status-badge" [ngClass]="{ available: d.value === 1, 'in-use': d.value === 2 }">
        {{ d.value === 1 ? 'Available' : d.value === 2 ? 'In Use' : 'Maintenance' }}
      </span>
    </div>
  </dx-data-grid>
  <div class="fab-container" *ngIf="selectedItemKeys.length > 0">
    <dx-button
      icon="cart"
      [text]="'Proceed (' + selectedItemKeys.length + ' items)'"
      type="default"
      stylingMode="contained"
      [height]="50"
      (onClick)="onProceed()"
    >
    </dx-button>
  </div>
</div>
